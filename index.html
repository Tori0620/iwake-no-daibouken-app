<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¤ãƒ¯ã‚±ã®å¤§å†’é™º</title>
    <!-- Tailwind CSS CDNã‚’èª­ã¿è¾¼ã¿ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - M PLUS Rounded 1c ã¨ Mochiy Pop P One ã‚’èª­ã¿è¾¼ã¿ -->
    <link href="https://fonts.googleapis.com/css2?family=Mochiy+Pop+P+One&family=M+PLUS+Rounded+1c:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* å…¨ä½“å…±é€šã‚¹ã‚¿ã‚¤ãƒ« */
        body {
            font-family: 'M PLUS Rounded 1c', sans-serif;
            background-color: var(--body-bg); /* CSSå¤‰æ•°ã§èƒŒæ™¯è‰²ã‚’è¨­å®š */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow-y: auto;
            padding: 1rem;
            box-sizing: border-box;
            position: relative;
            transition: background-color 0.5s ease; /* èƒŒæ™¯è‰²ã®å¤‰åŒ–ã‚’æ»‘ã‚‰ã‹ã« */
        }

        /* ã‚¿ã‚¤ãƒˆãƒ«ç”»é¢ã‚¹ã‚¿ã‚¤ãƒ« */
        .title-container {
            background-color: var(--container-bg); /* CSSå¤‰æ•°ã§æ ã®èƒŒæ™¯è‰²ã‚’è¨­å®š */
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            padding-top: 3rem;
            width: 100%;
            max-width: 400px;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .title-iwake-image {
            width: 200px;
            height: auto;
            margin-bottom: 0.5rem;
            filter: drop-shadow(0 0px 0px rgba(0, 0, 0, 0)); /* å½±ã‚’å‰Šé™¤ã¾ãŸã¯é€æ˜ã« */
        }
        .start-button {
            background-image: linear-gradient(to right, var(--button-gradient-start) 0%, var(--button-gradient-end) 100%); /* CSSå¤‰æ•°ã§ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¨­å®š */
            color: white;
            padding: 1rem 2.5rem;
            border-radius: 9999px;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out, border 0.3s ease-in-out;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            border: 3px solid var(--button-border); /* CSSå¤‰æ•°ã§æ ç·šè‰²ã‚’è¨­å®š */
            animation: bounce 1s infinite alternate;
            font-family: 'Mochiy Pop P One', sans-serif;
        }
        .start-button:hover {
            transform: translateY(-8px) scale(1.1);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            border-color: var(--button-hover-border); /* CSSå¤‰æ•°ã§ãƒ›ãƒãƒ¼æ™‚ã®æ ç·šè‰²ã‚’è¨­å®š */
        }
        @keyframes bounce {
            0% { transform: translateY(0); }
            100% { transform: translateY(-5px); }
        }

        /* ãƒ”ãƒ³ãƒã‚·ãƒãƒ¥ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³é¸æŠç”»é¢ã‚¹ã‚¿ã‚¤ãƒ« */
        .pinch-selection-container {
            background-color: var(--container-bg); /* CSSå¤‰æ•°ã§æ ã®èƒŒæ™¯è‰²ã‚’è¨­å®š */
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            width: 100%;
            max-width: 600px;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .pinch-title {
            font-family: 'Mochiy Pop P One', sans-serif;
            font-size: 2rem;
            color: #333;
            margin-bottom: 2rem;
        }
        .button-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            width: 100%;
            margin-bottom: 2rem;
        }
        .situation-button {
            background-image: linear-gradient(to right, var(--situation-button-gradient-start) 0%, var(--situation-button-gradient-end) 100%); /* CSSå¤‰æ•°ã§ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¨­å®š */
            color: white;
            padding: 1rem;
            border-radius: 15px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            border: none;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            min-height: 100px;
        }
        .situation-button:hover {
            transform: translateY(-3px) scale(1.03);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        .situation-button .emoji {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }
        .situation-button .text {
            font-size: 1.5rem; /* ãƒ”ãƒ³ãƒé¸æŠãƒœã‚¿ãƒ³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’ã•ã‚‰ã«å¤§ãã */
        }

        /* è¨€ã„è¨³ç”Ÿæˆç”»é¢ã‚¹ã‚¿ã‚¤ãƒ« */
        .excuse-generator-wrapper {
            width: 100%;
            max-width: 600px; /* å…¨ä½“ã®æœ€å¤§å¹… */
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding-top: 1rem; /* ä¸Šéƒ¨ã«å°‘ã—ä½™ç™½ */
        }
        .current-pinch-container {
            margin-bottom: 1rem; /* ãƒ¡ã‚¤ãƒ³ã‚«ãƒ¼ãƒ‰ã¨ã®é–“éš” */
            padding: 0.5rem 1rem;
            background-color: rgba(255, 255, 255, 0.8); /* å°‘ã—åŠé€æ˜ã®èƒŒæ™¯ */
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            z-index: 3; /* ãƒ¡ã‚¤ãƒ³ã‚«ãƒ¼ãƒ‰ã‚ˆã‚Šæ‰‹å‰ã«è¡¨ç¤º */
        }
        .current-pinch-text {
            font-family: 'Mochiy Pop P One', sans-serif;
            font-size: 1.8rem; /* ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’èª¿æ•´ */
            color: #333;
        }

        .excuse-generator-main-card {
            background-color: var(--container-bg); /* CSSå¤‰æ•°ã§æ ã®èƒŒæ™¯è‰²ã‚’è¨­å®š */
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 1.5rem; /* ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’èª¿æ•´ */
            padding-top: 20px; /* ã‚¤ãƒ¯ã‚±ã¨å¹ãå‡ºã—ãŒã¯ã¿å‡ºã‚‹åˆ†ã®ä½™ç™½ã‚’èª¿æ•´ */
            width: 100%;
            max-width: 450px; /* ã‚«ãƒ¼ãƒ‰ã®æœ€å¤§å¹… */
            min-height: 500px; /* ã‚«ãƒ¼ãƒ‰ã®æœ€å°é«˜ã•ã‚’ã•ã‚‰ã«ç¢ºä¿ */
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative; /* å­è¦ç´ ã®çµ¶å¯¾é…ç½®ã®ãŸã‚ */
            overflow: hidden; /* ã¯ã¿å‡ºã‚‹è¦ç´ ã‚’éš ã™ï¼ˆã‚¤ãƒ¯ã‚±ã¯ã¯ã¿å‡ºã•ã›ãªã„ï¼‰ */
            margin-top: -30px; /* ãƒ”ãƒ³ãƒã‚³ãƒ³ãƒ†ãƒŠã¨é‡ãªã‚‹ã‚ˆã†ã« */
        }

        .iwake-speaking-character {
            width: 250px; /* ã‚¤ãƒ¯ã‚±ç”»åƒã‚’èª¿æ•´ */
            height: auto;
            position: absolute; /* çµ¶å¯¾é…ç½® */
            bottom: 60px; /* ã‚¤ãƒ¯ã‚±ã‚’ã•ã‚‰ã«ä¸Šã«ç§»å‹• */
            right: 0px; /* ã‚¤ãƒ¯ã‚±ã‚’ã•ã‚‰ã«å·¦ã¸ï¼ˆã‚«ãƒ¼ãƒ‰ã®å³ç«¯ã«è¿‘ã¥ã‘ã‚‹ï¼‰ */
            z-index: 2; /* å¹ãå‡ºã—ã‚ˆã‚Šæ‰‹å‰ã«è¡¨ç¤º */
            filter: drop-shadow(0 8px 15px rgba(0, 0, 0, 0.3)); /* å½±ã‚’å¼·èª¿ */
        }

        .speech-bubble {
            position: absolute; /* çµ¶å¯¾é…ç½® */
            background-color: rgba(255, 255, 255, 0.95); /* ã»ã¼ä¸é€æ˜ãªç™½ */
            border: 2px solid #a7d9ed; /* è–„ã„é’ã®æ ç·š */
            border-radius: 40px; /* æ¥•å††ã«ã™ã‚‹ãŸã‚ã•ã‚‰ã«å¤§ãã */
            padding: 1rem; /* ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’èª¿æ•´ */
            width: 80%; /* ã‚«ãƒ¼ãƒ‰ã«å¯¾ã™ã‚‹å¹…ã‚’èª¿æ•´ */
            max-width: 350px; /* èª­ã¿ã‚„ã™ã•ã®ãŸã‚ã®æœ€å¤§å¹…ã‚’èª¿æ•´ */
            min-height: 120px; /* æœ€å°é«˜ã•ã‚’ç¢ºä¿ */
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
            z-index: 1; /* ã‚¤ãƒ¯ã‚±ã‚ˆã‚Šå¥¥ */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;

            top: 50px; /* ã‚«ãƒ¼ãƒ‰ã®ä¸Šã‹ã‚‰ã®ä½ç½®ã‚’èª¿æ•´ */
            left: 10px; /* ã‚«ãƒ¼ãƒ‰ã®å·¦ã‹ã‚‰ã®ä½ç½® */
        }

        .speech-bubble::before { /* å¹ãå‡ºã—ã®ã—ã£ã½ */
            content: '';
            position: absolute;
            bottom: -12px; /* å¹ãå‡ºã—ã®ä¸‹ç·šã‹ã‚‰å¤–ã«å‡ºã‚‹ */
            right: 10px; /* å¹ãå‡ºã—ã®å³å¯„ã‚Šã‹ã‚‰å‡ºã™ */
            transform: rotate(45deg); /* å³æ–œã‚ä¸‹ã«å‘ã‹ã†å½¢ */
            width: 20px; /* ã—ã£ã½ã®ã‚µã‚¤ã‚ºã‚’èª¿æ•´ */
            height: 20px; /* ã—ã£ã½ã®ã‚µã‚¤ã‚ºã‚’èª¿æ•´ */
            background-color: rgba(255, 255, 255, 0.95); /* å¹ãå‡ºã—æœ¬ä½“ã¨åŒã˜è‰² */
            border-bottom: 2px solid #a7d9ed; /* å¹ãå‡ºã—æœ¬ä½“ã¨åŒã˜æ ç·š */
            border-right: 2px solid #a7d9ed; /* å¹ãå‡ºã—æœ¬ä½“ã¨åŒã˜æ ç·š */
            z-index: 0; /* å¹ãå‡ºã—ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚ˆã‚Šå¥¥ */
        }

        .excuse-text-content { /* è¨€ã„è¨³ã¨ãƒ”ãƒ³ãƒãƒ†ã‚­ã‚¹ãƒˆã®ãƒ©ãƒƒãƒ‘ãƒ¼ */
            width: 100%;
        }
        .excuse-box-text { /* è¨€ã„è¨³ãƒ†ã‚­ã‚¹ãƒˆ */
            font-size: 1.1rem; /* ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’èª¿æ•´ */
            color: #333;
            line-height: 1.6;
            word-break: break-word;
        }
        .loading-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: var(--button-gradient-start); /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ãƒ”ãƒŠãƒ¼ã®è‰²ã‚‚é€£å‹• */
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* æˆ»ã‚‹ãƒœã‚¿ãƒ³ã¨SNSãƒœã‚¿ãƒ³ã®ã‚°ãƒ«ãƒ¼ãƒ— */
        .action-buttons-bottom-group {
            display: flex;
            flex-direction: column; /* ãƒœã‚¿ãƒ³ã‚’ç¸¦ã«ä¸¦ã¹ã‚‹ */
            align-items: center; /* ä¸­å¤®æƒãˆ */
            gap: 0.5rem; /* ãƒœã‚¿ãƒ³é–“ã®ã‚¹ãƒšãƒ¼ã‚¹ */
            width: 100%;
            position: absolute; /* ã‚«ãƒ¼ãƒ‰ã®ä¸‹éƒ¨ã«å›ºå®š */
            bottom: 1.5rem; /* ãƒœã‚¿ãƒ³ã®ä½ç½®ã‚’èª¿æ•´ */
            left: 50%;
            transform: translateX(-50%);
            max-width: calc(100% - 3rem); /* ã‚«ãƒ¼ãƒ‰ã®ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’è€ƒæ…® */
        }
        .back-button {
            background-image: linear-gradient(to right, var(--button-gradient-start) 0%, var(--button-gradient-end) 100%); /* ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³èƒŒæ™¯ */
            color: white;
            padding: 0.6rem 1.5rem; /* ãƒœã‚¿ãƒ³ã®ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’èª¿æ•´ */
            border-radius: 9999px; /* å®Œå…¨ãªä¸¸è§’ */
            font-size: 1.1rem; /* ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’èª¿æ•´ */
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out, border 0.2s ease-in-out;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* å½±ã‚’èª¿æ•´ */
            border: 2px solid var(--button-border); /* æ ç·šè‰²ã‚’è¨­å®š */
            width: 100%; /* è¦ªã®å¹…ã«åˆã‚ã›ã‚‹ */
            max-width: 200px; /* æœ€å¤§å¹… */
        }
        .back-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
            border-color: var(--button-hover-border); /* ãƒ›ãƒãƒ¼æ™‚ã®æ ç·šè‰² */
        }
        .share-buttons-row {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            width: 100%;
            margin-top: 0.5rem; /* æˆ»ã‚‹ãƒœã‚¿ãƒ³ã¨ã®é–“éš” */
        }
        .share-action-button {
            padding: 0.3rem 0.6rem; /* ãƒœã‚¿ãƒ³ã®ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’ã•ã‚‰ã«å°ã•ã */
            border-radius: 9999px; /* å®Œå…¨ãªä¸¸è§’ */
            font-size: 0.65rem; /* ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’ã•ã‚‰ã«å°ã•ã */
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* å½±ã‚’èª¿æ•´ */
            border: none; /* å›ºå®šè‰²ãªã®ã§ãƒœãƒ¼ãƒ€ãƒ¼ãªã— */
            flex-grow: 1; /* æ¨ªã«åºƒãŒã‚‹ */
            max-width: 100px; /* ãƒœã‚¿ãƒ³ã®æœ€å¤§å¹…ã‚’èª¿æ•´ */
            color: white; /* ãƒ†ã‚­ã‚¹ãƒˆè‰²ã‚’ç™½ã« */
            height: 30px; /* é«˜ã•ã‚’å›ºå®šã—ã¦ä½ãã™ã‚‹ */
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .share-action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
        }
        .share-x-button {
            background-color: #000000; /* Xã®ãƒ–ãƒ©ãƒ³ãƒ‰ã‚«ãƒ©ãƒ¼ */
        }
        .share-line-button {
            background-color: #00c300; /* LINEã®ãƒ–ãƒ©ãƒ³ãƒ‰ã‚«ãƒ©ãƒ¼ */
        }


        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ */
        @media (max-width: 640px) {
            .title-container, .pinch-selection-container, .excuse-generator-main-card {
                padding: 1.5rem;
                max-width: 95%;
            }
            .title-iwake-image {
                width: 150px;
            }
            .start-button {
                padding: 0.8rem 2rem;
                font-size: 1rem;
            }
            .pinch-title {
                font-size: 1.8rem;
            }
            .button-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .situation-button {
                min-height: 80px;
                font-size: 1rem;
            }
            .situation-button .emoji {
                font-size: 1.3rem;
            }
            .situation-button .text {
                font-size: 1.2rem; /* ãƒ¢ãƒã‚¤ãƒ«ã§ã®ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºèª¿æ•´ */
            }
            .current-pinch-container {
                margin-bottom: 0.8rem;
                padding: 0.4rem 0.8rem;
            }
            .current-pinch-text {
                font-size: 1.5rem;
            }
            .excuse-generator-main-card {
                padding-top: 50px; /* ãƒ¢ãƒã‚¤ãƒ«ã§ã®ã‚¤ãƒ¯ã‚±é£Ÿã„è¾¼ã¿èª¿æ•´ */
                min-height: 380px; /* ãƒ¢ãƒã‚¤ãƒ«ã§ã®æœ€å°é«˜ã•ã‚’ç¢ºä¿ */
            }
            .iwake-speaking-character {
                width: 160px; /* ãƒ¢ãƒã‚¤ãƒ«ã§ã®ã‚¤ãƒ¯ã‚±ç”»åƒã‚µã‚¤ã‚º */
                bottom: 50px; /* ãƒ¢ãƒã‚¤ãƒ«ã§ã®ä½ç½®èª¿æ•´ */
                right: 10px; /* ãƒ¢ãƒã‚¤ãƒ«ã§å°‘ã—å·¦ã«ç§»å‹• */
            }
            .speech-bubble {
                padding: 0.8rem;
                width: 85%;
                max-width: 220px;
                min-height: 90px;
                top: 20px;
                left: 20px; /* ãƒ¢ãƒã‚¤ãƒ«ã§å°‘ã—å³ã«ç§»å‹• */
            }
            .speech-bubble::before {
                bottom: -10px; /* ãƒ¢ãƒã‚¤ãƒ«ã§ã®ã—ã£ã½ä½ç½®èª¿æ•´ */
                right: 10px; /* ãƒ¢ãƒã‚¤ãƒ«ã§ã®ã—ã£ã½ä½ç½®èª¿æ•´ */
                width: 15px;
                height: 15px;
            }
            .excuse-box-text {
                font-size: 0.9rem;
            }
            .action-buttons-bottom-group {
                gap: 0.5rem;
                bottom: 0.8rem;
                padding-top: 0.8rem;
            }
            .back-button, .share-action-button {
                padding: 0.4rem 0.8rem;
                font-size: 0.7rem;
                max-width: 100px;
            }
            .share-action-button {
                height: 25px; /* ãƒ¢ãƒã‚¤ãƒ«ã§ã®é«˜ã•ã‚’èª¿æ•´ */
            }
        }
    </style>
</head>
<body>
    <script>
        // å…¨ã¦ã®ç”»é¢ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’JavaScriptå¤‰æ•°ã¨ã—ã¦å®šç¾©
        const titleScreenHtml = `
            <div class="title-container">
                <img src="https://i.imgur.com/0aMMhVq.png" alt="ã‚¤ãƒ¯ã‚±ã¨ã‚¿ã‚¤ãƒˆãƒ«" class="title-iwake-image">
                <button id="startButton" class="start-button">è¨€ã„è¨³ã‚’å§‹ã‚ã‚‹</button>
            </div>
        `;

        const pinchSituationsHtml = `
            <div class="pinch-selection-container">
                <h1 class="pinch-title">ãƒ”ãƒ³ãƒãªã‚·ãƒãƒ¥ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é¸ã‚“ã§ã­ï¼</h1>
                <div class="button-grid" id="situationButtons">
                    <!-- ã‚·ãƒãƒ¥ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ã¯JavaScriptã§å‹•çš„ã«ç”Ÿæˆã•ã‚Œã¾ã™ -->
                </div>
            </div>
        `;

        const excuseGeneratorHtml = `
            <div class="excuse-generator-wrapper">
                <div id="currentPinchContainer" class="current-pinch-container">
                    <h2 id="currentPinch" class="current-pinch-text"></h2>
                </div>
                <div class="excuse-generator-main-card">
                    <img src="https://i.imgur.com/OiU2ZfC.png" alt="è©±ã—ã¦ã„ã‚‹ã‚¤ãƒ¯ã‚±" class="iwake-speaking-character">
                    <div class="speech-bubble">
                        <div id="excuseDisplay" class="excuse-text-content">
                            <div class="loading-spinner hidden" id="loadingSpinner"></div>
                            <span id="excuseText" class="excuse-box-text">è¨€ã„è¨³ã‚’ç”Ÿæˆä¸­...</span>
                        </div>
                    </div>
                    <div class="action-buttons-bottom-group">
                        <button id="backToPinchSelectionButton" class="back-button">ãƒ”ãƒ³ãƒé¸æŠã«æˆ»ã‚‹</button>
                        <div class="share-buttons-row">
                            <button id="shareXButton" class="share-action-button share-x-button">Xã«æŠ•ç¨¿</button>
                            <button id="shareLineButton" class="share-action-button share-line-button">LINEã«æŠ•ç¨¿</button>
                        </div>
                    </div>
                </div>
            </div>
        `;

        // ã‚¢ãƒ—ãƒªã®ç¾åœ¨ã®çŠ¶æ…‹ã‚’ç®¡ç†ã™ã‚‹å¤‰æ•°
        let currentPinchSituation = '';

        // å®šç¾©ã•ã‚ŒãŸã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ
        const colorPalettes = [
            {
                bodyBg: '#f0f4f8', // Light Gray
                containerBg: '#ffffff', // White
                buttonGradient: ['#6a11cb', '#2575fc'], // Purple to Blue
                buttonBorder: '#ffffff', // White
                buttonHoverBorder: '#ffd700', // Gold
                situationButtonGradient: ['#ff7e5f', '#feb47b'] // Orange to Peach
            },
            {
                bodyBg: '#ffebee', // Light Pink
                containerBg: '#fffafa', // Slightly off-white pink
                buttonGradient: ['#ff6b6b', '#ff4d4d'], // Red to Red-Orange
                buttonBorder: '#ffffff',
                buttonHoverBorder: '#ffcc00', // Yellow
                situationButtonGradient: ['#8e24aa', '#d81b60'] // Purple to Pink
            },
            {
                bodyBg: '#e3f2fd', // Light Blue
                containerBg: '#f0f8ff', // Alice Blue
                buttonGradient: ['#2196f3', '#03a9f4'], // Blue to Light Blue
                buttonBorder: '#ffffff',
                buttonHoverBorder: '#ff9800', // Orange
                situationButtonGradient: ['#4caf50', '#8bc34a'] // Green to Light Green
            },
            {
                bodyBg: '#fffde7', // Light Yellow
                containerBg: '#fffff0', // Ivory
                buttonGradient: ['#ffc107', '#ffeb3b'], // Yellow to Light Yellow
                buttonBorder: '#ffffff',
                buttonHoverBorder: '#8d6e63', // Brown
                situationButtonGradient: ['#ff9800', '#ff5722'] // Orange to Deep Orange
            },
            {
                bodyBg: '#e8f5e9', // Light Green
                containerBg: '#f5fff5', // Mint Cream
                buttonGradient: ['#4caf50', '#8bc34a'], // Green to Light Green
                buttonBorder: '#ffffff',
                buttonHoverBorder: '#fbc02d', // Dark Yellow
                situationButtonGradient: ['#673ab7', '#5e35b1'] // Deep Purple
            }
        ];

        // ãƒ©ãƒ³ãƒ€ãƒ ãªè‰²ã‚’é©ç”¨ã™ã‚‹é–¢æ•°
        function applyRandomColors() {
            const randomPalette = colorPalettes[Math.floor(Math.random() * colorPalettes.length)];
            document.documentElement.style.setProperty('--body-bg', randomPalette.bodyBg);
            document.documentElement.style.setProperty('--container-bg', randomPalette.containerBg); // æ–°ã—ã„CSSå¤‰æ•°
            document.documentElement.style.setProperty('--button-gradient-start', randomPalette.buttonGradient[0]);
            document.documentElement.style.setProperty('--button-gradient-end', randomPalette.buttonGradient[1]);
            document.documentElement.style.setProperty('--button-border', randomPalette.buttonBorder);
            document.documentElement.style.setProperty('--button-hover-border', randomPalette.buttonHoverBorder);
            document.documentElement.style.setProperty('--situation-button-gradient-start', randomPalette.situationButtonGradient[0]);
            document.documentElement.style.setProperty('--situation-button-gradient-end', randomPalette.situationButtonGradient[1]);
        }

        // ç”»é¢ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹ãƒ¡ã‚¤ãƒ³é–¢æ•°
        function renderScreen(screenName, data = {}) {
            document.body.innerHTML = ''; // ç¾åœ¨ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ã‚¯ãƒªã‚¢
            applyRandomColors(); // ç”»é¢ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹ãŸã³ã«è‰²ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«å¤‰æ›´

            if (screenName === 'title') {
                document.body.innerHTML = titleScreenHtml;
                document.getElementById('startButton').addEventListener('click', () => {
                    renderScreen('pinchSelection');
                });
            } else if (screenName === 'pinchSelection') {
                document.body.innerHTML = pinchSituationsHtml;
                const situations = [
                    { id: 1, emoji: 'â°', text: 'è¿”ä¿¡é…ã‚Œæ°—å‘³' },
                    { id: 2, emoji: 'ğŸ“', text: 'é€£çµ¡æŠœã‘' },
                    { id: 3, emoji: 'â±ï¸', text: 'æ™‚é–“ãšã‚Œ' },
                    { id: 4, emoji: ' ', text: 'ãƒ‡ãƒ¼ã‚¿æœªé€ä¿¡' },
                    { id: 5, emoji: 'ğŸ“', text: 'å ´æ‰€é•ã„' },
                    { id: 6, emoji: 'ğŸ—“ï¸', text: 'äºˆå®šã‹ã¶ã‚Š' },
                    { id: 7, emoji: 'ğŸ“', text: 'é›»è©±å‡ºå¿˜ã‚Œ' },
                    { id: 8, emoji: 'ğŸ—“ï¸', text: 'ã‚¢ãƒå¿˜ã‚Œ' },
                    { id: 9, emoji: 'â³', text: 'ç· åˆ‡å‹˜é•ã„' },
                    { id: 10, emoji: 'ğŸ˜´', text: 'æœå¯åŠ' }
                ];
                const situationButtonsContainer = document.getElementById('situationButtons');
                situations.forEach(situation => {
                    const button = document.createElement('button');
                    button.className = 'situation-button';
                    button.innerHTML = `
                        <span class="emoji">${situation.emoji}</span>
                        <span class="text">${situation.text}</span>
                    `;
                    button.addEventListener('click', () => {
                        currentPinchSituation = situation.text; // é¸æŠã•ã‚ŒãŸãƒ”ãƒ³ãƒã‚’ä¿å­˜
                        renderScreen('excuseGenerator', { situation: situation.text });
                    });
                    situationButtonsContainer.appendChild(button);
                });
            } else if (screenName === 'excuseGenerator') {
                document.body.innerHTML = excuseGeneratorHtml;
                const excuseDisplay = document.getElementById('excuseDisplay');
                const excuseText = document.getElementById('excuseText');
                const loadingSpinner = document.getElementById('loadingSpinner');
                const currentPinchTextElement = document.getElementById('currentPinch');
                const shareXButton = document.getElementById('shareXButton');
                const shareLineButton = document.getElementById('shareLineButton');
                const backToPinchSelectionButton = document.getElementById('backToPinchSelectionButton');

                // ãƒ”ãƒ³ãƒçŠ¶æ³ã‚’è¨­å®š
                if (data.situation) {
                    currentPinchTextElement.textContent = `ãƒ”ãƒ³ãƒ: ${data.situation}`;
                    generateExcuse(data.situation);
                } else {
                    currentPinchTextElement.textContent = 'ãƒ”ãƒ³ãƒãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“';
                    excuseText.textContent = 'å‰ã®ç”»é¢ã«æˆ»ã£ã¦ãƒ”ãƒ³ãƒã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚';
                    loadingSpinner.classList.add('hidden');
                }

                // SNSå…±æœ‰æ©Ÿèƒ½ (æ–°ã—ã„ãƒœã‚¿ãƒ³ã«å‰²ã‚Šå½“ã¦)
                shareXButton.addEventListener('click', () => {
                    const textToShare = excuseText.textContent;
                    const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(textToShare)}&hashtags=è¨€ã„è¨³ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼,ã‚¤ãƒ¯ã‚±ã®å¤§å†’é™º`;
                    window.open(twitterUrl, '_blank');
                });

                shareLineButton.addEventListener('click', () => {
                    const textToShare = excuseText.textContent;
                    const lineUrl = `https://social-plugins.line.me/lineit/share?text=${encodeURIComponent(textToShare)}`;
                    window.open(lineUrl, '_blank');
                });

                // æˆ»ã‚‹ãƒœã‚¿ãƒ³
                backToPinchSelectionButton.addEventListener('click', () => {
                    renderScreen('pinchSelection'); // ãƒ”ãƒ³ãƒé¸æŠç”»é¢ã«æˆ»ã‚‹
                });

                // è¨€ã„è¨³ã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°
                async function generateExcuse(situation) {
                    excuseText.textContent = ''; // ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢
                    loadingSpinner.classList.remove('hidden'); // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ãƒ”ãƒŠãƒ¼ã‚’è¡¨ç¤º
                    excuseDisplay.style.justifyContent = 'center'; // ã‚¹ãƒ”ãƒŠãƒ¼ã‚’ä¸­å¤®ã«

                    try {
                        // Gemini APIã‚’å‘¼ã³å‡ºã—ã¦è¨€ã„è¨³ã‚’ç”Ÿæˆ
                        let chatHistory = [];
                        const prompt = `${situation}ã¨ã„ã†ãƒ”ãƒ³ãƒãªã‚·ãƒãƒ¥ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã«å¯¾ã™ã‚‹ã€ç”³ã—è¨³ãªã•ã‚’ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªæ–¹æ³•ã§è‡ªå·±é˜²è¡›ã—ã‚ˆã†ã¨ã™ã‚‹ã€ã¡ã‚‡ã£ã¨ä¸å™¨ç”¨ã§æ„›å¬Œã®ã‚ã‚‹è¿”ç­”ã‚’30å€‹ã€ç®‡æ¡æ›¸ãã§ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚å„è¿”ç­”ã¯çŸ­ãã€å…·ä½“çš„ãªå†…å®¹ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚JSONå½¢å¼ã§è¿”ã—ã¦ãã ã•ã„ã€‚ä¾‹: {"excuses": ["ä¸å™¨ç”¨ãªè¿”ç­”1", "ä¸å™¨ç”¨ãªè¿”ç­”2", "..."]}`;
                        chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                        const payload = {
                            contents: chatHistory,
                            generationConfig: {
                                responseMimeType: "application/json",
                                responseSchema: {
                                    type: "OBJECT",
                                    properties: {
                                        "excuses": {
                                            type: "ARRAY",
                                            items: { "type": "STRING" }
                                        }
                                    },
                                    "propertyOrdering": ["excuses"]
                                }
                            }
                        };
                        const apiKey = "AIzaSyDM5dowUgUUnqTKatvH1-9KJL4kbtw05fc"; // CanvasãŒè‡ªå‹•ã§æä¾›
                        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                        console.log("APIãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡ä¸­...", payload); // ãƒªã‚¯ã‚¨ã‚¹ãƒˆå†…å®¹ã‚’ãƒ­ã‚°å‡ºåŠ›

                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (!response.ok) {
                            const errorBody = await response.text();
                            throw new Error(`HTTPã‚¨ãƒ©ãƒ¼! ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ${response.status}, ãƒ¬ã‚¹ãƒãƒ³ã‚¹: ${errorBody}`);
                        }

                        const result = await response.json();
                        console.log("Gemini API Response (Raw):", result); // ç”Ÿã®APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ãƒ­ã‚°å‡ºåŠ›

                        if (result.candidates && result.candidates.length > 0 &&
                            result.candidates[0].content && result.candidates[0].content.parts &&
                            result.candidates[0].content.parts.length > 0) {
                            const jsonString = result.candidates[0].content.parts[0].text;
                            console.log("Gemini API Response (JSON String):", jsonString); // JSONæ–‡å­—åˆ—ã‚’ãƒ­ã‚°å‡ºåŠ›

                            try {
                                const parsedJson = JSON.parse(jsonString);
                                const excuses = parsedJson.excuses;

                                if (excuses && excuses.length > 0) {
                                    const randomIndex = Math.floor(Math.random() * excuses.length);
                                    excuseText.textContent = excuses[randomIndex]; // ãƒ©ãƒ³ãƒ€ãƒ ãªè¨€ã„è¨³ã‚’è¡¨ç¤º
                                    excuseDisplay.style.justifyContent = 'flex-start'; // ãƒ†ã‚­ã‚¹ãƒˆè¡¨ç¤ºã«åˆã‚ã›ã¦èª¿æ•´
                                } else {
                                    excuseText.textContent = 'è¨€ã„è¨³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚';
                                    excuseDisplay.style.justifyContent = 'center';
                                    console.warn("APIã¯JSONã‚’è¿”ã—ãŸãŒã€excusesé…åˆ—ãŒç©ºã¾ãŸã¯è¦‹ã¤ã‹ã‚‰ãªã„ã€‚");
                                }
                            } catch (jsonParseError) {
                                excuseText.textContent = 'APIã‹ã‚‰ã®å¿œç­”ã®è§£æã«å¤±æ•—ã—ã¾ã—ãŸã€‚';
                                excuseDisplay.style.justifyContent = 'center';
                                console.error('JSONè§£æã‚¨ãƒ©ãƒ¼:', jsonParseError);
                                console.error('è§£æã«å¤±æ•—ã—ãŸJSONæ–‡å­—åˆ—:', jsonString);
                            }
                        } else {
                            excuseText.textContent = 'è¨€ã„è¨³ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚APIã‹ã‚‰ã®å¿œç­”ãŒäºˆæœŸã›ã¬å½¢å¼ã§ã™ã€‚';
                            excuseDisplay.style.justifyContent = 'center';
                            console.error('APIå¿œç­”ã®æ§‹é€ ãŒä¸æ­£:', result);
                        }
                    } catch (error) {
                        console.error('è¨€ã„è¨³ç”Ÿæˆã‚¨ãƒ©ãƒ¼:', error);
                        excuseText.textContent = `ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚è©³ç´°: ${error.message}`;
                        excuseDisplay.style.justifyContent = 'center';
                    } finally {
                        loadingSpinner.classList.add('hidden'); // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ãƒ”ãƒŠãƒ¼ã‚’éè¡¨ç¤º
                    }
                }
            }
        }

        // ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã«ã‚¿ã‚¤ãƒˆãƒ«ç”»é¢ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
        document.addEventListener('DOMContentLoaded', () => {
            renderScreen('title');
        });
    </script>
</body>
</html>

